(function(){"use strict";function a(a,b,c){return c.indexOf(a)===b}function b(a){return JSON.parse(JSON.stringify(a))}function c(a){Object.keys(h).forEach(function(b){b=h[b],void 0!==a?void 0!==b.modules[a]&&delete b.modules[a]:b.modules={}})}function d(b,c){for(var e in c)void 0===b&&(b=c instanceof Array?[]:{}),c[e]instanceof Array?(void 0===b[e]&&(b[e]=[]),b[e]=b[e].concat(c[e]).filter(a)):b[e]="object"==typeof c[e]?d(b[e],c[e]):c[e];return b}function e(a,b,c){if(""===b)return a;if("string"==typeof b)return e(a,b.split("."),c);if(1===b.length&&void 0!==c)return a[b[0]]=c;if(0===b.length)return a;var d=a[b[0]],f=b.slice(1);return e(d,f,c)}function f(a,b){var c=h[a].modules;void 0===c[b.name]&&(c[b.name]=[]),c[b.name].push(b)}function g(a){Object.keys(h).forEach(function(b){var c=h[b].modules;void 0!==c[a.name]&&c[a.name].length>0&&(c[a.name].forEach(function(b){0===a.key.indexOf(b.key)&&b.callback(j[a.name])}),h[b].end(a))})}var h,i="undefined"!=typeof module&&module.exports?require("es6-promise").Promise:this.Promise,j={},k={setConf:function(a,c){j[a]=b(c),g({name:a,key:""})},setSubConf:function(a,c,d){e(j[a],c,b(d)),g({name:a,key:c})},getSubConf:function(a,b){return void 0===b&&(b=""),e(j[a],b)},mergeConf:function(a,b,c){if(void 0===j[a])throw"Application does not have any name named "+a;if("object"!=typeof c)throw"Target key not an object";var f=e(j[a],b);if("object"!=typeof f)throw"Key value key not an object";d(c,f)},getConf:function(a,b){return new i(function(c){void 0!==b&&(c=b),void 0===j[a]?f("get",{name:a,callback:b,key:""}):c(j[a])})},subscribe:function(a,b,c){f("sub",{name:a,callback:c,key:b}),void 0!==j[a]&&c(j[a])},size:function(){return Object.keys(j).length},clear:function(a){void 0===a?(j={},c(a)):(delete j[a],c(a))}};h={get:{end:function(a){h.get.modules[a.name]=[]},modules:{}},sub:{end:function(){},modules:{}}},"function"==typeof define&&define.amd?define(function(){return k}):"undefined"!=typeof module&&module.exports?module.exports=k:this.confity=k}).call(this);